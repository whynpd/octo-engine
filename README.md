# Freshdesk to JIRA Integration

This project contains scripts to extract ticket data from Freshdesk and prepare it for import into JIRA.

## Setup

### 1. Install Dependencies

```bash
pip3 install requests python-dotenv
```

### 2. Environment Variables

Create a `.env` file in the project root with your Freshdesk credentials:

```bash
# Copy the template
cp env_template.txt .env

# Edit the .env file with your actual values
FRESHDESK_DOMAIN=your-freshdesk-domain.freshdesk.com
FRESHDESK_API_KEY=your-freshdesk-api-key
```

### 3. Get Your Freshdesk API Key

1. Log into your Freshdesk account
2. Go to Profile Settings → API Keys
3. Generate a new API key
4. Copy the API key to your `.env` file

### 4. Get Your Freshdesk Domain

Your Freshdesk domain is the subdomain part of your Freshdesk URL. For example:
- If your Freshdesk URL is `https://company.freshdesk.com`, your domain is `company.freshdesk.com`
- If your Freshdesk URL is `https://support.yourcompany.com`, your domain is `support.yourcompany.com`

## Usage

### Step 1: Get Ticket IDs
```bash
python3 step1_get_ticket_ids.py
```

### Step 2: Extract Ticket Details
```bash
python3 step2_extract_ticket_details.py
```

### Step 3: Download Attachments
```bash
python3 step3_download_attachments.py
```

### Complete Extraction
```bash
python3 complete_extraction.py
```

## Step 3: Attachment Download

The `step3_download_attachments.py` script:

- **Parses JSON files** generated by previous steps
- **Finds attachment URLs** in ticket data and conversations
- **Downloads attachments** to folders named by ticket ID
- **Organizes files** in `attachments/` directory structure:
  ```
  attachments/
  ├── 12345/
  │   ├── document.pdf
  │   ├── screenshot.png
  │   └── conv_reply.docx
  ├── 12346/
  │   └── attachment.zip
  └── ...
  ```

**Features:**
- ✅ Handles both ticket attachments and conversation attachments
- ✅ Sanitizes filenames for filesystem safety
- ✅ Prevents duplicate downloads
- ✅ Shows download progress and summary
- ✅ Uses Freshdesk API authentication
- ✅ Error handling for failed downloads

## Security Notes

- Never commit your `.env` file to version control
- The `.env` file is already in `.gitignore` to prevent accidental commits
- All scripts now use environment variables instead of hardcoded credentials
- API keys are validated at runtime to ensure they're properly set

## Files

- `step1_get_ticket_ids.py` - Extracts basic ticket information
- `step2_extract_ticket_details.py` - Gets detailed ticket information including conversations
- `step3_download_attachments.py` - Downloads attachments from JSON files
- `complete_extraction.py` - Complete extraction workflow
- `test_api.py` - Test Freshdesk API connection
- `test_ticket_details.py` - Test individual ticket extraction
- `env_template.txt` - Template for environment variables 